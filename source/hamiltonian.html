<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="The hamiltonian describes the problem we want to tackle. It contains all the relevant information defining the physical system.">

<title>bounce - Hamiltonian</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="bounce - Hamiltonian">
<meta property="og:description" content="The hamiltonian describes the problem we want to tackle. It contains all the relevant information defining the physical system.">
<meta property="og:site-name" content="bounce">
<meta name="twitter:title" content="bounce - Hamiltonian">
<meta name="twitter:description" content="The hamiltonian describes the problem we want to tackle. It contains all the relevant information defining the physical system.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">bounce</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/BorjaRequena/bounce/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Hamiltonian</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">BOUNCE</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Documentation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../source/environment.html" class="sidebar-item-text sidebar-link">Environment</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../source/agents.html" class="sidebar-item-text sidebar-link">Agents</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../source/hamiltonian.html" class="sidebar-item-text sidebar-link active">Hamiltonian</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../source/sdp.html" class="sidebar-item-text sidebar-link">Semidefinite programming</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../source/training.html" class="sidebar-item-text sidebar-link">Training</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../source/utils.html" class="sidebar-item-text sidebar-link">Utils</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Tutorials</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorial/introduction.html" class="sidebar-item-text sidebar-link">Constraint optimization with reinforcement learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorial/benchmarking.html" class="sidebar-item-text sidebar-link">Benchmarking agents</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorial/transfer_learning.html" class="sidebar-item-text sidebar-link">Transfer learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorial/entanglement_witnessing.html" class="sidebar-item-text sidebar-link">Energy-based entanglement witnesses</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorial/plots.html" class="sidebar-item-text sidebar-link">Plots</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#graph" id="toc-graph" class="nav-link active" data-scroll-target="#graph">Graph</a>
  <ul class="collapse">
  <li><a href="#graph-1" id="toc-graph-1" class="nav-link" data-scroll-target="#graph-1">Graph</a></li>
  <li><a href="#chain1d" id="toc-chain1d" class="nav-link" data-scroll-target="#chain1d">Chain1D</a></li>
  <li><a href="#squarelattice" id="toc-squarelattice" class="nav-link" data-scroll-target="#squarelattice">SquareLattice</a></li>
  </ul></li>
  <li><a href="#hamiltonian" id="toc-hamiltonian" class="nav-link" data-scroll-target="#hamiltonian">Hamiltonian</a>
  <ul class="collapse">
  <li><a href="#hamiltonian-1" id="toc-hamiltonian-1" class="nav-link" data-scroll-target="#hamiltonian-1">Hamiltonian</a></li>
  <li><a href="#local-hamiltonians" id="toc-local-hamiltonians" class="nav-link" data-scroll-target="#local-hamiltonians">Local Hamiltonians</a>
  <ul class="collapse">
  <li><a href="#localhamiltonian" id="toc-localhamiltonian" class="nav-link" data-scroll-target="#localhamiltonian">LocalHamiltonian</a></li>
  <li><a href="#isinghamiltonian" id="toc-isinghamiltonian" class="nav-link" data-scroll-target="#isinghamiltonian">IsingHamiltonian</a></li>
  </ul></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization">Visualization</a></li>
  <li><a href="#heisenberg-models" id="toc-heisenberg-models" class="nav-link" data-scroll-target="#heisenberg-models">Heisenberg models</a>
  <ul class="collapse">
  <li><a href="#xxhamiltonian" id="toc-xxhamiltonian" class="nav-link" data-scroll-target="#xxhamiltonian">XXHamiltonian</a></li>
  <li><a href="#xyhamiltonian" id="toc-xyhamiltonian" class="nav-link" data-scroll-target="#xyhamiltonian">XYHamiltonian</a></li>
  <li><a href="#xyzhamiltonian" id="toc-xyzhamiltonian" class="nav-link" data-scroll-target="#xyzhamiltonian">XYZHamiltonian</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#serializing" id="toc-serializing" class="nav-link" data-scroll-target="#serializing">Serializing</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/BorjaRequena/bounce/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Hamiltonian</h1>
</div>

<div>
  <div class="description">
    The hamiltonian describes the problem we want to tackle. It contains all the relevant information defining the physical system.
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="graph" class="level1">
<h1>Graph</h1>
<p>Before going into the actual Hamiltonians, we introduce the <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#graph"><code>Graph</code></a> class, which is an essential constituent of the <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#hamiltonian"><code>Hamiltonian</code></a>.</p>
<hr>
<p><a href="https://github.com/BorjaRequena/bounce/blob/main/bounce/hamiltonian.py#L19" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="graph-1" class="level3">
<h3 class="anchored" data-anchor-id="graph-1">Graph</h3>
<blockquote class="blockquote">
<pre><code> Graph (nodes, edges)</code></pre>
</blockquote>
<p>Initialize self. See help(type(self)) for accurate signature.</p>
<p>We define the structure of the problem with a <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#graph"><code>Graph</code></a>, upon which we introduce the interactions. In order to create a <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#graph"><code>Graph</code></a>, we need to provide a list of nodes and edges, which are the links between nodes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>nodes, edges <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>]), [np.array([<span class="dv">0</span>, <span class="dv">1</span>]), np.array([<span class="dv">0</span>, <span class="dv">2</span>])]</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> Graph(nodes, edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> (g.nodes <span class="op">==</span> nodes).<span class="bu">all</span>()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> np.<span class="bu">all</span>([e_graph <span class="op">==</span> e <span class="cf">for</span> e_graph, e <span class="kw">in</span> <span class="bu">zip</span>(g.edges, edges)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Furthermore, <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#graph"><code>Graph</code></a>s provide some useful properties that provide useful information about the graph.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> g.n_nodes <span class="op">==</span> <span class="bu">len</span>(nodes)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> g.n_edges <span class="op">==</span> <span class="bu">len</span>(edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We have predefined some common graph structures in typical physical systems, such as a one-dimensional chain or a two-dimensional square lattice, both with or without periodic boundary conditions (denoted as <code>pbc</code>). However, notice that implementing graphs allows us to tackle problems with arbitrary dimensions and connectivities.</p>
<hr>
<p><a href="https://github.com/BorjaRequena/bounce/blob/main/bounce/hamiltonian.py#L30" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="chain1d" class="level3">
<h3 class="anchored" data-anchor-id="chain1d">Chain1D</h3>
<blockquote class="blockquote">
<pre><code> Chain1D (N, pbc=True)</code></pre>
</blockquote>
<p>Create a one-dimensional chain of <code>N</code> nodes and periodic boundary conditions <code>pbc</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> Chain1D(<span class="dv">6</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>chain.nodes, chain.edges</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(array([0, 1, 2, 3, 4, 5]),
 [array([0, 1]),
  array([1, 2]),
  array([2, 3]),
  array([3, 4]),
  array([4, 5]),
  array([0, 5])])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> (chain.nodes <span class="op">==</span> np.arange(<span class="dv">6</span>)).<span class="bu">all</span>()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>edges <span class="op">=</span> [np.sort([i, (i<span class="op">+</span><span class="dv">1</span>)<span class="op">%</span><span class="dv">6</span>]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">6</span>)]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> np.<span class="bu">all</span>([e_chain <span class="op">==</span> e <span class="cf">for</span> e_chain, e <span class="kw">in</span> <span class="bu">zip</span>(chain.edges, edges)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/BorjaRequena/bounce/blob/main/bounce/hamiltonian.py#L39" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="squarelattice" class="level3">
<h3 class="anchored" data-anchor-id="squarelattice">SquareLattice</h3>
<blockquote class="blockquote">
<pre><code> SquareLattice (N, M, pbc=True)</code></pre>
</blockquote>
<p>Create a NxM square lattice with periodic boundary conditions <code>pbc</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>lattice <span class="op">=</span> SquareLattice(<span class="dv">3</span>, <span class="dv">4</span>, pbc<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>lattice.edges</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[array([0, 1]),
 array([0, 4]),
 array([1, 2]),
 array([1, 5]),
 array([2, 3]),
 array([2, 6]),
 array([3, 7]),
 array([4, 5]),
 array([4, 8]),
 array([5, 6]),
 array([5, 9]),
 array([6, 7]),
 array([ 6, 10]),
 array([ 7, 11]),
 array([8, 9]),
 array([ 9, 10]),
 array([10, 11])]</code></pre>
</div>
</div>
</section>
</section>
<section id="hamiltonian" class="level1">
<h1>Hamiltonian</h1>
<hr>
<p><a href="https://github.com/BorjaRequena/bounce/blob/main/bounce/hamiltonian.py#L82" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="hamiltonian-1" class="level3">
<h3 class="anchored" data-anchor-id="hamiltonian-1">Hamiltonian</h3>
<blockquote class="blockquote">
<pre><code> Hamiltonian (graph, interactions)</code></pre>
</blockquote>
<p>Create a Hamiltonian over a graph with defined interactions.</p>
<p>Once we have laid out the topology of the problem, we can define the <code>interactions</code> happening in the system. These, together with the underlying <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#graph"><code>Graph</code></a>, define a <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#hamiltonian"><code>Hamiltonian</code></a>. The <code>interactions</code> come in the form of a list of tuples indicating the support and the interaction term <code>[(support, term)]</code>. We describe the terms using Pauli matrices <span class="math inline">\(\sigma^x, \sigma^y, \sigma^z\)</span> and the identity. Given that these are the variables that the <code>SDPSolver</code> uses to instantiate and solve the optimization problem, we need to write them in terms of <code>picos</code> varibales. We provide the variables <code>x</code>, <code>y</code>, <code>z</code>, <code>Id</code> within the <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#hamiltonian"><code>Hamiltonian</code></a> class to ease the process of defining Hamiltonians for new problems.</p>
<p>For instance, in the case of non-interacting qubits with a transverse field, described by <span class="math inline">\(H = \sum_i\sigma^x_i\)</span>, the interactions would be <code>[(0, x), (1, x), ...]</code>. On an Ising-like Hamiltonian, such as <span class="math inline">\(H=J\sum_i\sigma^z_i\sigma^z_{i+1} + B\sum_i\sigma^x_i\)</span>, we have to account for the tensor product <span class="math inline">\(\sigma^z_i\sigma^z_{i+1}\)</span>, which in the picos library is performed with the <code>@</code> operator. Hence, we would define the interactions as <code>[(0, B*x), (1, B*x), ..., ([0, 1], J*z@z), ([1, 2], J*z@z), ...]</code>. In fact, the supports should be <code>np.ndarrays</code>, e.g., <code>np.array([0, 1])</code>, which we take from the <code>Graph.edges</code>, and we should access the Pauli variables from the <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#hamiltonian"><code>Hamiltonian</code></a> with <code>self</code>, e.g., <code>self.x</code>.</p>
<p>Finally, in order to keep a consistent file naming, we provide the Hamiltonians with a <code>name</code> property that is a string naming the model. We show some examples below.</p>
</section>
<section id="local-hamiltonians" class="level2">
<h2 class="anchored" data-anchor-id="local-hamiltonians">Local Hamiltonians</h2>
<p>For now, there are issues pickling some picos instances, which we use to define the interactions (see <a href="https://borjarequena.github.io/BOUNCE/hamiltonian.html#Serializing">serializing</a> below). We use the <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#localhamiltonian"><code>LocalHamiltonian</code></a> class to define a way to pickle the <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#hamiltonian"><code>Hamiltonian</code></a> class assuming 2-local Hamiltonians, which encompasses most physically relevant Hamiltonians.</p>
<hr>
<p><a href="https://github.com/BorjaRequena/bounce/blob/main/bounce/hamiltonian.py#L140" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="localhamiltonian" class="level3">
<h3 class="anchored" data-anchor-id="localhamiltonian">LocalHamiltonian</h3>
<blockquote class="blockquote">
<pre><code> LocalHamiltonian (graph, interactions, *aux_args)</code></pre>
</blockquote>
<p>Local Hamiltonian with two-body interactions. This class defines a structure for 2-local Hamiltonians of the form cls(graph, one_body_amplitudes, two_body_amplitudes, *aux_args). This allows us to serialize Hamiltonians with the <strong>reduce</strong> method, which we do not want to explicitly define for every new Hamiltonian. Let us know if you find any better solution to this.</p>
<p>Let’s see how to implement a transverse field Ising Hamiltonian and instantiate it in the onedimensional chain.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> IsingHamiltonian(LocalHamiltonian):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, graph, field, coupling):</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        field, coupling <span class="op">=</span> arrayfy(field, graph.n_nodes), arrayfy(coupling, graph.n_edges)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        one_body_terms <span class="op">=</span> [(np.array([n]), field[n]<span class="op">*</span><span class="va">self</span>.x) <span class="cf">for</span> n <span class="kw">in</span> graph.nodes]</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        two_body_terms <span class="op">=</span> [(edge, coupling[e]<span class="op">*</span><span class="va">self</span>.z<span class="op">@</span>self.z) <span class="cf">for</span> e, edge <span class="kw">in</span> <span class="bu">enumerate</span>(graph.edges)]</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        interactions <span class="op">=</span> one_body_terms <span class="op">+</span> two_body_terms</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(graph, interactions)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.name <span class="op">=</span> <span class="st">'ising'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/BorjaRequena/bounce/blob/main/bounce/hamiltonian.py#L157" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="isinghamiltonian" class="level3">
<h3 class="anchored" data-anchor-id="isinghamiltonian">IsingHamiltonian</h3>
<blockquote class="blockquote">
<pre><code> IsingHamiltonian (graph, field, coupling)</code></pre>
</blockquote>
<p>Local Hamiltonian with two-body interactions. This class defines a structure for 2-local Hamiltonians of the form cls(graph, one_body_amplitudes, two_body_amplitudes, *aux_args). This allows us to serialize Hamiltonians with the <strong>reduce</strong> method, which we do not want to explicitly define for every new Hamiltonian. Let us know if you find any better solution to this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>b, j <span class="op">=</span> <span class="fl">0.75</span>, <span class="fl">2.5</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>H_ising <span class="op">=</span> IsingHamiltonian(chain, b, j)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>H_ising.interactions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[(array([0]), &lt;2×2 Real Constant: 0.75·x&gt;),
 (array([1]), &lt;2×2 Real Constant: 0.75·x&gt;),
 (array([2]), &lt;2×2 Real Constant: 0.75·x&gt;),
 (array([3]), &lt;2×2 Real Constant: 0.75·x&gt;),
 (array([4]), &lt;2×2 Real Constant: 0.75·x&gt;),
 (array([5]), &lt;2×2 Real Constant: 0.75·x&gt;),
 (array([0, 1]), &lt;4×4 Real Constant: 2.5·z⊗z&gt;),
 (array([1, 2]), &lt;4×4 Real Constant: 2.5·z⊗z&gt;),
 (array([2, 3]), &lt;4×4 Real Constant: 2.5·z⊗z&gt;),
 (array([3, 4]), &lt;4×4 Real Constant: 2.5·z⊗z&gt;),
 (array([4, 5]), &lt;4×4 Real Constant: 2.5·z⊗z&gt;),
 (array([0, 5]), &lt;4×4 Real Constant: 2.5·z⊗z&gt;)]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>H_ising.to_sdp()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[(array([0]), &lt;2×2 Real Constant: 0.75·x&gt;),
 (array([1]), &lt;2×2 Real Constant: 0.75·x&gt;),
 (array([2]), &lt;2×2 Real Constant: 0.75·x&gt;),
 (array([3]), &lt;2×2 Real Constant: 0.75·x&gt;),
 (array([4]), &lt;2×2 Real Constant: 0.75·x&gt;),
 (array([5]), &lt;2×2 Real Constant: 0.75·x&gt;),
 (array([0, 1]), &lt;4×4 Real Constant: 2.5·z⊗z&gt;),
 (array([1, 2]), &lt;4×4 Real Constant: 2.5·z⊗z&gt;),
 (array([2, 3]), &lt;4×4 Real Constant: 2.5·z⊗z&gt;),
 (array([3, 4]), &lt;4×4 Real Constant: 2.5·z⊗z&gt;),
 (array([4, 5]), &lt;4×4 Real Constant: 2.5·z⊗z&gt;),
 (array([0, 5]), &lt;4×4 Real Constant: 2.5·z⊗z&gt;)]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> H_ising.to_sdp() <span class="op">==</span> H_ising.interactions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="visualization" class="level2">
<h2 class="anchored" data-anchor-id="visualization">Visualization</h2>
<p>Furthermore, we have provided the <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#hamiltonian"><code>Hamiltonian</code></a> class with a <code>draw</code> method. This provides us with a pictorial representation of the Hamiltonian. We represent the interaction strength with the edge transparency, and the on-site terms with the node colors. The scales are between the smallest to the largest value, so they provide an idea of the relative strengths.</p>
<p>We have given the different graphs a <code>layout</code> method that determines the position of the nodes in the plot. You do not need to define a specific layout in your own graphs, as the function will use the <code>networkx.kamada_kawai_layout</code> by default (mainly because the name is cool). For example, we have given a circular layout to the <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#chain1d"><code>Chain1D</code></a> using the predefined with <code>networkx.circular_layout</code>.</p>
<p>Let’s see how it looks in our example Ising Hamiltonian.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>H_ising.draw()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="02_hamiltonian_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>In the case of a lattice, we have created our own custom a square-lattice-like pattern which adapts to periodic boundary conditions. Let’s first see how it looks with inhomogeneous parameters and without periodic boundary conditions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>b, j <span class="op">=</span> [<span class="fl">0.</span>, <span class="fl">0.5</span>, <span class="fl">1.</span>], [<span class="fl">0.</span>, <span class="fl">0.75</span>, <span class="fl">1.5</span>]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>H_ising <span class="op">=</span> IsingHamiltonian(lattice, b, j)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>H_ising.draw()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="02_hamiltonian_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Notice here that we do not explicitly define the values of the interacting terms for every node and edge. The <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#hamiltonian"><code>Hamiltonian</code></a> takes care to replicate the pattern along the nodes and edges by order. The behaviour is consistent, although we do not recommend using this property unless you are confident it works as expected. It is mainly intended to perform simple patterns like homogeneous Hamiltonians, such as the one we defined before, or alternating exchange in one dimension.</p>
</div>
</div>
<p>In case you want to exploit it, we recommend paying close attention to the edge ordering. In the <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#chain1d"><code>Chain1D</code></a> the edges go in increasing order. In the <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#squarelattice"><code>SquareLattice</code></a>, we sequentially parse the lattice rows from left to right, and top to bottom. We start at the first node and create two edges: the horizontal towards the right and the vertical downwards. This takes into account periodic boundary conditions.</p>
<p>Let’s see now a lattice with periodic boundary conditions! (We’re proud of this plotting :3)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>lattice <span class="op">=</span> SquareLattice(<span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>b, j <span class="op">=</span> [<span class="fl">0.</span>, <span class="fl">0.5</span>, <span class="fl">1.</span>], [<span class="fl">0.1</span>, <span class="fl">0.75</span>, <span class="fl">1.5</span>]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>H_ising <span class="op">=</span> IsingHamiltonian(lattice, b, j)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>H_ising.draw()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="02_hamiltonian_files/figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="heisenberg-models" class="level2">
<h2 class="anchored" data-anchor-id="heisenberg-models">Heisenberg models</h2>
<p>In the presented work, we study a special case of the Heisenberg XY model. The quantum Heisenberg XY model is given by <span class="math display">\[H=\sum_{i} J_{i}((1+\gamma)\sigma_{i}^x \sigma_{i+1}^x + (1-\gamma)\sigma_{i}^y \sigma_{i+1}^y) + \sum_{i}B_{i}\sigma_{i}^z,\]</span> where <span class="math inline">\(J_i\)</span> is the pair-wise antiferromagnetic exchange and <span class="math inline">\(B_i\)</span> is the strength of the on-site magnetic field. The parameter <span class="math inline">\(\gamma\)</span> induces an anisotropic interaction between directions <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. In the limit of <span class="math inline">\(\gamma=0\)</span>, we have the so-called XX model <span class="math display">\[H=\sum_{i} J_{i}(\sigma_{i}^x \sigma_{i+1}^x + \sigma_{i}^y \sigma_{i+1}^y) + \sum_{i}B_{i}\sigma_{i}^z\,,\]</span> whose results we report on the work <a href="https://journals.aps.org/prresearch/abstract/10.1103/PhysRevResearch.5.013097">Certificates of quantum many-body properties assisted by machine learning</a>.</p>
<hr>
<p><a href="https://github.com/BorjaRequena/bounce/blob/main/bounce/hamiltonian.py#L180" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="xxhamiltonian" class="level3">
<h3 class="anchored" data-anchor-id="xxhamiltonian">XXHamiltonian</h3>
<blockquote class="blockquote">
<pre><code> XXHamiltonian (graph, linear, quadratic)</code></pre>
</blockquote>
<p>Local Hamiltonian with two-body interactions. This class defines a structure for 2-local Hamiltonians of the form cls(graph, one_body_amplitudes, two_body_amplitudes, *aux_args). This allows us to serialize Hamiltonians with the <strong>reduce</strong> method, which we do not want to explicitly define for every new Hamiltonian. Let us know if you find any better solution to this.</p>
<hr>
<p><a href="https://github.com/BorjaRequena/bounce/blob/main/bounce/hamiltonian.py#L167" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="xyhamiltonian" class="level3">
<h3 class="anchored" data-anchor-id="xyhamiltonian">XYHamiltonian</h3>
<blockquote class="blockquote">
<pre><code> XYHamiltonian (graph, linear, quadratic, gamma)</code></pre>
</blockquote>
<p>Local Hamiltonian with two-body interactions. This class defines a structure for 2-local Hamiltonians of the form cls(graph, one_body_amplitudes, two_body_amplitudes, *aux_args). This allows us to serialize Hamiltonians with the <strong>reduce</strong> method, which we do not want to explicitly define for every new Hamiltonian. Let us know if you find any better solution to this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>xy <span class="op">=</span> XYHamiltonian(chain, <span class="fl">0.5</span>, <span class="fl">1.</span>, <span class="fl">0.2</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>xy.interactions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[(array([0]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([1]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([2]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([3]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([4]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([5]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([0, 1]), &lt;4×4 Complex Constant: 1.2·x⊗x + 0.8·y⊗y&gt;),
 (array([1, 2]), &lt;4×4 Complex Constant: 1.2·x⊗x + 0.8·y⊗y&gt;),
 (array([2, 3]), &lt;4×4 Complex Constant: 1.2·x⊗x + 0.8·y⊗y&gt;),
 (array([3, 4]), &lt;4×4 Complex Constant: 1.2·x⊗x + 0.8·y⊗y&gt;),
 (array([4, 5]), &lt;4×4 Complex Constant: 1.2·x⊗x + 0.8·y⊗y&gt;),
 (array([0, 5]), &lt;4×4 Complex Constant: 1.2·x⊗x + 0.8·y⊗y&gt;)]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>xx <span class="op">=</span> XXHamiltonian(chain, <span class="fl">0.5</span>, <span class="fl">1.</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>xx.interactions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[(array([0]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([1]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([2]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([3]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([4]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([5]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([0, 1]), &lt;4×4 Complex Constant: x⊗x + y⊗y&gt;),
 (array([1, 2]), &lt;4×4 Complex Constant: x⊗x + y⊗y&gt;),
 (array([2, 3]), &lt;4×4 Complex Constant: x⊗x + y⊗y&gt;),
 (array([3, 4]), &lt;4×4 Complex Constant: x⊗x + y⊗y&gt;),
 (array([4, 5]), &lt;4×4 Complex Constant: x⊗x + y⊗y&gt;),
 (array([0, 5]), &lt;4×4 Complex Constant: x⊗x + y⊗y&gt;)]</code></pre>
</div>
</div>
<p>For completeness, we provide an additional example of the Heisenberg Hamiltonian including interaction in the <span class="math inline">\(\sigma^z\)</span> direction <span class="math display">\[H=\sum_i J_i(\sigma_{i}^x\sigma_{i+1}^x + \sigma_{i}^y\sigma_{i+1}^y + \sigma_{i}^z\sigma_{i+1}^z) + \sum_i B_i\sigma_i^z\]</span> This model, with <span class="math inline">\(B_i=0 \ \forall i\)</span>, is used in <a href="https://iopscience.iop.org/article/10.1088/1742-6596/1163/1/012057">[1]</a>. See the <a href="https://borjarequena.github.io/BOUNCE/sdp.html">SdP docs</a> for further details.</p>
<hr>
<p><a href="https://github.com/BorjaRequena/bounce/blob/main/bounce/hamiltonian.py#L187" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="xyzhamiltonian" class="level3">
<h3 class="anchored" data-anchor-id="xyzhamiltonian">XYZHamiltonian</h3>
<blockquote class="blockquote">
<pre><code> XYZHamiltonian (graph, linear, quadratic)</code></pre>
</blockquote>
<p>Local Hamiltonian with two-body interactions. This class defines a structure for 2-local Hamiltonians of the form cls(graph, one_body_amplitudes, two_body_amplitudes, *aux_args). This allows us to serialize Hamiltonians with the <strong>reduce</strong> method, which we do not want to explicitly define for every new Hamiltonian. Let us know if you find any better solution to this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>xyz <span class="op">=</span> XYZHamiltonian(chain, <span class="fl">0.5</span>, <span class="fl">1.5</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>xyz.interactions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[(array([0]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([1]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([2]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([3]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([4]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([5]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([0, 1]), &lt;4×4 Complex Constant: 1.5·(x⊗x + y⊗y + z⊗z)&gt;),
 (array([1, 2]), &lt;4×4 Complex Constant: 1.5·(x⊗x + y⊗y + z⊗z)&gt;),
 (array([2, 3]), &lt;4×4 Complex Constant: 1.5·(x⊗x + y⊗y + z⊗z)&gt;),
 (array([3, 4]), &lt;4×4 Complex Constant: 1.5·(x⊗x + y⊗y + z⊗z)&gt;),
 (array([4, 5]), &lt;4×4 Complex Constant: 1.5·(x⊗x + y⊗y + z⊗z)&gt;),
 (array([0, 5]), &lt;4×4 Complex Constant: 1.5·(x⊗x + y⊗y + z⊗z)&gt;)]</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="serializing" class="level1">
<h1>Serializing</h1>
<p>There are some issues serializing <code>picos.Expressions</code>. In our Hamiltonians we find <code>picos.ComplexAffineExpressions</code>, which are unpicklable. Hence, this restricts the way we can copy as well as save and load the Hamiltonians.</p>
<p>For this reason, we have defined a <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#hamiltonian.__deepcopy__"><code>Hamiltonian.__deepcopy__</code></a> method, which returns a deep copy of all the parameters except for a shallow copy of the interactions. Furthermore, we have defined a <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#localhamiltonian.__reduce__"><code>LocalHamiltonian.__reduce__</code></a> method that allows us to serielize local Hamiltonians. This allows us to both deepcopy and save/load local Hamiltonians. However, all local Hamiltonians must be initialized with the syntax <code>LocalHamiltonian(graph, one_body_amplitudes, two_body_amplitudes, *auxiliary_args)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>fun, args <span class="op">=</span> xx.__reduce__()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>fun, args</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(__main__.XXHamiltonian,
 (&lt;__main__.Chain1D&gt;,
  [0.5, 0.5, 0.5, 0.5, 0.5, 0.5],
  [1.0, 1.0, 1.0, 1.0, 1.0, 1.0]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>xx_new <span class="op">=</span> fun(<span class="op">*</span>args)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>xx_new.interactions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[(array([0]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([1]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([2]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([3]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([4]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([5]), &lt;2×2 Real Constant: 0.5·z&gt;),
 (array([0, 1]), &lt;4×4 Complex Constant: x⊗x + y⊗y&gt;),
 (array([1, 2]), &lt;4×4 Complex Constant: x⊗x + y⊗y&gt;),
 (array([2, 3]), &lt;4×4 Complex Constant: x⊗x + y⊗y&gt;),
 (array([3, 4]), &lt;4×4 Complex Constant: x⊗x + y⊗y&gt;),
 (array([4, 5]), &lt;4×4 Complex Constant: x⊗x + y⊗y&gt;),
 (array([0, 5]), &lt;4×4 Complex Constant: x⊗x + y⊗y&gt;)]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> xx.interactions <span class="op">==</span> xx_new.interactions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With the <code>__reduce__</code> method we can also deepcopy the Hamiltonians.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>xx_copy <span class="op">=</span> deepcopy(xx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> xx.interactions <span class="op">==</span> xx_copy.interactions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The only issue with the way we have implemented the <code>__reduce__</code> method is that, whenever the parent class has more input arguments than the child one, we need to manually fix it in the child one. For instance, <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#xyhamiltonian"><code>XYHamiltonian</code></a> takes the input <code>gamma</code>, but the <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#xxhamiltonian"><code>XXHamiltonian</code></a>, which inherits from the first one, does not have any additional argument besides the graph, the linear and the quadratic terms. In this case, we have to set <code>XXHamiltonian.aux_args = []</code> after calling <code>super().__init__</code> in the <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#xxhamiltonian.__init__"><code>XXHamiltonian.__init__</code></a>. Otherwise, the serializer will break due to an excess of input arguments trying to feed <code>gamma</code> into <a href="https://BorjaRequena.github.io/bounce/source/hamiltonian.html#xxhamiltonian"><code>XXHamiltonian</code></a>.</p>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p>[1] F. Uskov and O. Lychkovskiy. <a href="https://iopscience.iop.org/article/10.1088/1742-6596/1163/1/012057">A variational lower bound on the ground state of a many-body system and the squaring parametrization of density matrices</a>. <em>Journal of Physics: Conference Series</em> <strong>1163</strong> 012057 (2019)</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>