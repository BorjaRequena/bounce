---

title: Semidefinite programming 


keywords: fastai
sidebar: home_sidebar

summary: "Toolkit to solve the semi-definite program defined by the set of constraints and Hamiltonian."
description: "Toolkit to solve the semi-definite program defined by the set of constraints and Hamiltonian."
nb_path: "nbs/06_sdp.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/06_sdp.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="solve_sdp" class="doc_header"><code>solve_sdp</code><a href="https://github.com/BorjaRequena/bounce/tree/master/bounce/sdp.py#L11" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>solve_sdp</code>(<strong><code>layout</code></strong>, <strong><code>hamiltonian</code></strong>)</p>
</blockquote>
<p>Solves the SDP defined by the given layout and Hamiltonian.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="complementary_system" class="doc_header"><code>complementary_system</code><a href="https://github.com/BorjaRequena/bounce/tree/master/bounce/sdp.py#L58" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>complementary_system</code>(<strong><code>subsystem</code></strong>, <strong><code>size</code></strong>)</p>
</blockquote>
<p>Obtains the complementary system of subsystem.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="picos2np" class="doc_header"><code>picos2np</code><a href="https://github.com/BorjaRequena/bounce/tree/master/bounce/sdp.py#L62" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>picos2np</code>(<strong><code>variable</code></strong>)</p>
</blockquote>
<p>Converts picos variable (even sparse) to numpy matrix.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The SdP is built imposing the compatibility contraints from the layout. There, we simply provide a list of <code>np.array</code> containing the support for each reduced density matrix (RDM) that we consider. In the following example, we solve the SdP given the example Hamiltonian and imposing compatibility over a single pair of sites. We will consider the RDMs $\rho_0, \rho_1, \rho_2, \rho_3, \rho_4, \rho_{50}$ in a ring with 6 sites, which is the same as the set of constraints $C=\{\{0\},\{1\},\{2\},\{3\},\{4\},\{5,0\}\}$. The function <a href="/BOUNCE/utils.html#fill_layout"><code>fill_layout</code></a> allows us to skip the 1-body terms when providing the set of constraints, as it will fill any site that is not contained within the provided constraints with its corresponding 1-body term.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">B</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="k">3</span> for i in range(N)]
<span class="n">H</span> <span class="o">=</span> <span class="n">XXHamiltonian</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With the Hamiltonian, define the set of constraints.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">simple_layout</span> <span class="o">=</span> <span class="n">fill_layout</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">])],</span> <span class="n">N</span><span class="p">)</span>
<span class="n">simple_layout</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[array([0, 5]), array([1]), array([2]), array([3]), array([4])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And now we can solve the associated SdP to the Hamiltonian with the given set of constraints.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">solve_sdp</span><span class="p">(</span><span class="n">simple_layout</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>-15.999999999012134</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Tightening the constraints we can obtain a better energy bound. For instance, adding a 3-body constraint to the previous set.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stronger_layout</span> <span class="o">=</span> <span class="n">fill_layout</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">])],</span> <span class="n">N</span><span class="p">)</span>
<span class="n">stronger_layout</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[array([1, 2, 3]), array([0, 5]), array([4])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">solve_sdp</span><span class="p">(</span><span class="n">stronger_layout</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>-12.4721359498209</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cost-estimation">Cost estimation<a class="anchor-link" href="#Cost-estimation"> </a></h2><p>In order to have an estimation of the computational cost required to solve a given SdP, we estimate the amount of free variables in the optimization problem.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ojimetro" class="doc_header"><code>ojimetro</code><a href="https://github.com/BorjaRequena/bounce/tree/master/bounce/sdp.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ojimetro</code>(<strong><code>L</code></strong>)</p>
</blockquote>
<p>Estimates the amount of free parameters in the SDP associated to the layout.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Following with our previous example, the first set of constraints was rather loose, providing a low energy bound. However, the second set of constraints provided a tighter bound, although the SdP was harder to solve.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ojimetro</span><span class="p">(</span><span class="n">simple_layout</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>31</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ojimetro</span><span class="p">(</span><span class="n">stronger_layout</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>83</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With the first set of constraints, the resulting SdP had 31 free variables to optimize, while the second SdP had to deal with 83. Tighter energy bounds usually come at the cost of higher computational costs.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Other-methods">Other methods<a class="anchor-link" href="#Other-methods"> </a></h2><p>We implement two other methods to obtain lower bounds of many-body Hamiltonians. We rewrite the Anderson bound <a href="https://journals.aps.org/pr/abstract/10.1103/PhysRev.83.1260">[1]</a> and the method introduced by Uskov and Lichovskiy in <a href="https://iopscience.iop.org/article/10.1088/1742-6596/1163/1/012057">[2]</a> in SdP form to compare with the proposed methodology above. The SdP formulation ensures that the obtained result is the actual global minimum.</p>
<p>The main limitation of these methods is not taking into account compatibility constraints between the reduced density matrices spanning the system. Furthermore, they rely on symmetries (such as translational invariance) and can, thus, not be used to solve inhomogeneous systems. Conversely, the approach we introduced above can be nautrally complemented by introducing additional constratints stemming from any previously known symmetry from the system.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="anderson_bound" class="doc_header"><code>anderson_bound</code><a href="https://github.com/BorjaRequena/bounce/tree/master/bounce/sdp.py#L81" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>anderson_bound</code>(<strong><code>hamiltonian</code></strong>, <strong><code>cluster_size</code></strong>=<em><code>3</code></em>)</p>
</blockquote>
<p>Provides the corresponding Anderson bound to the Hamiltonian given a cluster size.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="uskov_lichkovskiy_bound" class="doc_header"><code>uskov_lichkovskiy_bound</code><a href="https://github.com/BorjaRequena/bounce/tree/master/bounce/sdp.py#L113" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>uskov_lichkovskiy_bound</code>(<strong><code>hamiltonian</code></strong>, <strong><code>cluster_size</code></strong>=<em><code>3</code></em>)</p>
</blockquote>
<p>Provides the corresponding Uskov and Lichkovskiy bound to the Hamiltonian given a cluster size.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The results from <a href="https://iopscience.iop.org/article/10.1088/1742-6596/1163/1/012057">[2]</a> can be reproduced by properly adjusting the cluster size and using the following Hamiltonian.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">linear</span><span class="p">,</span> <span class="n">quadratic</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">N</span>
<span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">XYZHamiltonian</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">linear</span><span class="p">,</span> <span class="n">quadratic</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cluster_size</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">bound_anderson</span> <span class="o">=</span> <span class="n">anderson_bound</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">,</span> <span class="n">cluster_size</span><span class="o">=</span><span class="n">cluster_size</span><span class="p">)</span>
<span class="n">bound_uskov</span> <span class="o">=</span> <span class="n">uskov_lichkovskiy_bound</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">,</span> <span class="n">cluster_size</span><span class="o">=</span><span class="n">cluster_size</span><span class="p">)</span>

<span class="n">layout</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="n">cluster_size</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>) for i in np.arange(0, N, cluster_size-3)]
<span class="n">bound_ours</span> <span class="o">=</span> <span class="n">solve_sdp</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">hamiltonian</span><span class="p">)</span>

<span class="n">bound_anderson</span><span class="o">/</span><span class="n">N</span><span class="p">,</span> <span class="n">bound_uskov</span><span class="o">/</span><span class="n">N</span><span class="p">,</span> <span class="n">bound_ours</span><span class="o">/</span><span class="n">N</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(-1.9278862525095595, -1.8685170845449277, -1.868517086761974)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="References">References<a class="anchor-link" href="#References"> </a></h2><p>[1] P. W. Anderson. <a href="https://journals.aps.org/pr/abstract/10.1103/PhysRev.83.1260">Limits on the Energy of the Antiferromagnetic Ground State</a>. <em>Physical Review</em> <strong>83</strong>, 1260 (1951)</p>
<p>[2] F. Uskov and O. Lychkovskiy. <a href="https://iopscience.iop.org/article/10.1088/1742-6596/1163/1/012057">A variational lower bound on the ground state of a many-body system and the squaring parametrization of density matrices</a>. <em>Journal of Physics: Conference Series</em> <strong>1163</strong> 012057 (2019)</p>

</div>
</div>
</div>
</div>
 

